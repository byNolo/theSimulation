# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [0.4.1] - 2025-12-23 - ANNOUNCEMENTS & POLISH

### Added
- **Announcement System**: Integrated system to broadcast updates via site popup and/or Nolofication (email/push).
- **Rich HTML Templates**: Added support for styled announcement templates, including a dedicated "AI Launch" theme.
- **Admin Test Tools**: Added "Test AI Generation" to preview events, summaries, and chatter without affecting the live game.

### Fixed
- **Server Stability**: Increased Gunicorn and LLM timeouts (to 120s/60s) to prevent worker timeouts during complex AI generation.
- **Admin UI**: Fixed duplicate buttons and API client exports.
- **Backend Decorators**: Fixed missing imports for auth decorators in API routes.

## [0.4.0] - 2025-12-23 - AI NARRATIVE UPDATE

### Added
- **AI Event Generation**: Daily events are now dynamically generated by AI (OpenRouter/DeepSeek) based on world state and recent history.
- **AI Narrative Summaries**: Each day concludes with an atmospheric journal entry summarizing the outcome.
- **Dynamic Community Chatter**: "Social media" comments are now AI-generated with threaded replies, reacting to specific events and morale levels.
- **Frontend "Daily Briefing"**: New dashboard card displaying the narrative summary of the previous day.
- **Enhanced History View**: Event history now includes the narrative outcome for each day.

## [0.3.1] - 2025-12-22 - BUG FIXES AND IMPROVEMENTS

### Fixed
- **Admin Tick Logic**: Manual "Tick Day" now correctly executes all game mechanics (decay, disasters, projects) instead of just advancing the day.
- **Base Command**: System now automatically starts construction on the winning project when the previous one finishes or voting concludes.
- **Project List**: Hidden obsolete legacy projects from the UI to prevent confusion.
- **Game Over Detection**: Added explicit logging for "Game Over" states (Morale/Supplies <= 0 or Threat >= 100) in the daily event log.
- **Population Stat**: Fixed issue where population count was stuck at 20.

## [0.3.0] - 2025-12-14 - MAJOR GAME BALANCE OVERHAUL

### Added - Game Mechanics
- Passive Decay System: Stats decline daily (-4 supplies, -2 morale, +2 threat base)
- Random Disaster System: 15% daily chance (8 disaster types)
- Cascade Failure Mechanics: Critical stats trigger compound penalties
- Population System: Community size affects consumption and production
- Project Buff Application: Completed projects provide daily bonuses
- 6 New Extreme Crisis Events: plague, raid, betrayal, famine, collapse, winter
- 15 Balanced Projects: All essential for survival with meaningful buffs

### Changed - Balance
- ALL event deltas amplified 2-3x (much bigger impact per choice)
- Production formula increased from 0.1x to 0.15x
- Crisis triggers now at 25-30 instead of 20 (more frequent)
- Projects changed from optional to essential for survival

### Added - Technical
- New `server/game_mechanics.py` module with 6 core functions
- Population field in world_states table
- Migration script and project initialization script
- Comprehensive documentation (3 new markdown files)

### Changed - Code
- Completely rewrote `finalize_day()` with all new mechanics
- Updated `/state` API endpoint to return population
- Enhanced telemetry to track all new systems

---

## [Unreleased]

### Added
- Initial release with core gameplay
- 38+ dynamic events across 4 categories
- OAuth authentication via KeyN
- Admin dashboard with event management
- Custom event creation system
- Real-time vote tallies
- Dynamic background effects based on world state
- Stat information modals
- Glass-morphism UI design
- Mobile responsive design

### Features
- **Event System**: Crisis, Opportunity, Narrative, and General events
- **World Stats**: Morale, Supplies, Threat tracking
- **Admin Tools**: Create/edit/delete custom events, view metrics, manual day tick
- **Authentication**: Secure OAuth 2.0 login
- **UI/UX**: Modern design with hover effects, animations, responsive layout

## [0.1.0] - 2025-11-08

### Added
- Project initialization
- Basic gameplay loop
- Database schema
- Frontend and backend structure

---

## Version History Notes

### Upcoming Features (Planned)
- [ ] Public history/timeline page
- [ ] User profile with voting history
- [ ] Countdown timer to next day
- [ ] Email/push notifications
- [ ] Statistics dashboard
- [ ] Comments/discussion system
- [ ] Achievement system
- [ ] Special rare events
